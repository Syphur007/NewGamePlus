
import React, { useState, useEffect } from 'react';
import { PlayDate, User, Game, MatchRequest, Match, PlayDateRequest } from "@/entities/all";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { CalendarClock, Check, X, Users } from "lucide-react";
import { format } from 'date-fns';
import { toast, Toaster } from "sonner";

import MatchRequestCard from "../components/matches/MatchRequestCard";
import MessagingSystem from "../components/profile/MessagingSystem";

export default function PlayDatesPage() {
    const [currentUser, setCurrentUser] = useState(null);
    const [playDates, setPlayDates] = useState([]);
    const [matchRequests, setMatchRequests] = useState([]);
    const [users, setUsers] = useState({});
    const [games, setGames] = useState({});
    const [isLoading, setIsLoading] = useState(true);
    const [messagingUser, setMessagingUser] = useState(null);

    useEffect(() => {
        loadPageData();
    }, []);

    const loadPageData = async () => {
        setIsLoading(true);
        try {
            const user = await User.me();
            setCurrentUser(user);

            const [allUsers, allGames, allPlayDates, allMatchRequests] = await Promise.all([
 